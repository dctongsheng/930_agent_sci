data_test_1={
  "records": [
  {
    "viewType": "",
    "subnet": "",
    "id": "26412c7d89bf48bcb0916f885ae0ed8c",
    "projectId": "P1600787473158537217",
    "status": "0",
    "delFlag": "0",
    "processId": "Stereo_Miner_Clustering",
    "fileExtension": "",
    "env": "",
    "parentId": "1780858330605449217",
    "createTime": "2025-05-29 16:39:49",
    "menuLabel": "",
    "downloadType": "",
    "menuId": "26412c7d89bf48bcb0916f885ae0ed8c",
    "menuStatus": "0",
    "menuSort": "1",
    "dataType": "1",
    "searchName": "2",
    "systemType": "0",
    "menuPath": "/Files/RawData",
    "menuName": "2"
},
  {
    "checkCode": "429167780",
    "commonTag": "un_is_send_cnsa",
    "barcodeLen": "",
    "subnet": "hpc",
    "refrenece": "",
    "memo": "",
    "tissue": "",
    "pid": "",
    "path": "/zfsms3/ST_STOMICS/STOmics_cloud/odms/test/dcs_cloud/P1871461072416366593/Files/ResultData/Workflow/W202506120003255/stdout",
    "sampleRandomNo": "",
    "zone": "st",
    "id": "899cd30a29024e75a8e79b9f05ac6ad5",
    "tag": "",
    "umiLocation": "",
    "batchNo": "WF2025061210187",
    "mapping": "stdout",
    "sampleId": "123",
    "wfName": "",
    "bussinessName": "时空workflow",
    "sampleNum": "",
    "sampleName": "",
    "sampleType": "",
    "sampleIntegrity": "",
    "resultNote": "",
    "sequenceType": "",
    "libraryNum": "",
    "slide": "",
    "barcode": "",
    "sequencePlatform": "",
    "basicQualityValue": "",
    "q30": "",
    "q20": "",
    "readNum": "",
    "baseNum": "",
    "estErr": "",
    "srcFilePath": "/zdsms1/ST_NOTEBOOK/P20Z10200N0039/workflow/test/cromwell-executions-volcano/Hello/12a1d31f-34b8-47e8-b115-699bd246e0d3/call-sayHello/execution/1111.h5ad",
    "umiStartPos": "",
    "omicsType": "STOmics",
    "omics": "STOmics",
    "fileSize": "247",
    "name": "1111.h5ad",
    "fastqType": "",
    "projectId": "P1871461072416366593",
    "status": "0",
    "metadataType": 0,
    "barcodeStart": "",
    "delFlag": "0",
    "sid": "1933091680321863682",
    "umiLen": "",
    "fileStatus": "0",
    "processId": "Stereo_Miner_Clustering",
    "fileExtension": "stdout",
    "bussinessCode": "202406170032",
    "chipId": "",
    "lane": "",
    "chipCategory": "",
    "creator": "hujiaming",
    "dyeType": "",
    "env": "",
    "parentId": "ce0c33632fa84a6fb1c265e8fe31a189",
    "createTime": "2025-06-12 17:23:58",
    "species": "",
    "readLen": "",
    "taskId": "W202506120003255",
    "downloadType": "0",
    "metadataId": "47f02fbafece421a92d8bc2bce27c85c",
    "metadataMenuId": "ce0c33632fa84a6fb1c265e8fe31a189",
    "projectName": "",
    "businessType": "",
    "projectType": "",
    "productType": "",
    "chipSpecs": "",
    "experimentProcess": "",
    "isMicroscopeFile": "",
    "qcResultFile": "",
    "imageToolType": "",
    "manufacture": "",
    "imageQcVersion": "",
    "stereoResepSwitch": "",
    "iprVersion": "",
    "processVersion": "1.0.0",
    "splitCount": "",
    "cbLength": "",
    "cbStart": "",
    "libraryType": "",
    "subProject": "",
    "snId": "",
    "menuId": "ce0c33632fa84a6fb1c265e8fe31a189",
    "menuStatus": "0",
    "menuSort": "1",
    "dataType": "0",
    "searchName": "stdout",
    "menuPath": "/Files/ResultData/Workflow/W202506120003255",
    "trackCrossQcPassFlag": "",
    "stitchedImage": "",
    "menuName": "W202506120003255",
    "wfTag": "Stereo_Miner_Clustering",
    "linkType": "2"
  },
  {
    "checkCode": "3685340396",
    "commonTag": "un_is_send_cnsa",
    "barcodeLen": "",
    "subnet": "hpc",
    "refrenece": "",
    "memo": "",
    "tissue": "",
    "pid": "",
    "path": "/zfsms3/ST_STOMICS/STOmics_cloud/odms/test/dcs_cloud/P1871461072416366593/Files/ResultData/Workflow/W202506120003255/input.json",
    "sampleRandomNo": "",
    "zone": "st",
    "id": "11550f6b07ef4fcf83ee5cea4f091c02",
    "tag": "",
    "umiLocation": "",
    "batchNo": "WF2025061210187",
    "mapping": "input.json",
    "sampleId": "123",
    "wfName": "",
    "wfTag": "Stereo_Miner_Clustering",
    "bussinessName": "时空workflow",
    "sampleNum": "",
    "sampleName": "",
    "sampleType": "",
    "sampleIntegrity": "",
    "resultNote": "",
    "sequenceType": "",
    "libraryNum": "",
    "slide": "",
    "barcode": "",
    "sequencePlatform": "",
    "basicQualityValue": "",
    "q30": "",
    "q20": "",
    "readNum": "",
    "baseNum": "",
    "estErr": "",
    "srcFilePath": "/zdsms1/ST_NOTEBOOK/P20Z10200N0039/workflow/test/param/users/st_stomics/P20Z10200N0039/WF2025061210187/1933091680321863682/input.json",
    "umiStartPos": "",
    "omicsType": "",
    "omics": "genomics",
    "fileSize": "136",
    "name": "input.json",
    "fastqType": "",
    "projectId": "P1871461072416366593",
    "status": "0",
    "metadataType": 0,
    "barcodeStart": "",
    "delFlag": "0",
    "sid": "1933091680321863682",
    "umiLen": "",
    "fileStatus": "0",
    "processId": "Hello_multiple",
    "fileExtension": "json",
    "bussinessCode": "202406170032",
    "chipId": "",
    "lane": "",
    "chipCategory": "",
    "creator": "hujiaming",
    "dyeType": "",
    "env": "",
    "parentId": "ce0c33632fa84a6fb1c265e8fe31a189",
    "createTime": "2025-06-12 17:23:58",
    "species": "",
    "readLen": "",
    "taskId": "W202506120003255",
    "downloadType": "0",
    "metadataId": "f9c270ac5a204094934cf7edaaeb9e2a",
    "metadataMenuId": "ce0c33632fa84a6fb1c265e8fe31a189",
    "projectName": "",
    "businessType": "",
    "projectType": "",
    "productType": "",
    "chipSpecs": "",
    "experimentProcess": "",
    "isMicroscopeFile": "",
    "qcResultFile": "",
    "imageToolType": "",
    "manufacture": "",
    "imageQcVersion": "",
    "stereoResepSwitch": "",
    "iprVersion": "",
    "processVersion": "1.0.0",
    "splitCount": "",
    "cbLength": "",
    "cbStart": "",
    "libraryType": "",
    "subProject": "",
    "snId": "",
    "menuId": "ce0c33632fa84a6fb1c265e8fe31a189",
    "menuStatus": "0",
    "menuSort": "1",
    "dataType": "0",
    "searchName": "input.json",
    "menuPath": "/Files/ResultData/Workflow/W202506120003255",
    "trackCrossQcPassFlag": "",
    "stitchedImage": "",
    "menuName": "W202506120003255",
    "linkType": "2"
  }
  ]
  }

plan_desc={
          "planning_steps": [
            {
              "title": "数据预处理",
              "tools": "scanpy",
              "step": 1,
              "previous_step": [],
              "name": "数据预处理",
              "oid": "scanpy_preprocess",
              "description": "对输入的h5ad文件进行预处理，包括质量控制、标准化和特征选择。质量控制将过滤掉低质量的细胞和基因，标准化将消除技术噪音，特征选择将识别高变基因用于后续分析。",
              "input": "{\"input_data\": [\".h5ad\"]}",
              "output": "{\"processed_data\": [\".h5ad\"]}",
              "plan_type": "wdl"
            },
            {
              "title": "拟时序分析",
              "tools": "monocle2",
              "step": 2,
              "previous_step": [
                "1"
              ],
              "name": "拟时序分析",
              "oid": "monocle2_pseudotime",
              "description": "使用monocle2进行拟时序分析，推断细胞在发育或分化过程中的时间顺序。该步骤将构建细胞轨迹，计算每个细胞的拟时序值，并识别轨迹上的分支点。关键参数包括选择的高变基因数量和降维方法。",
              "input": "{\"processed_data\": [\".h5ad\"]}",
              "output": "{\"trajectory_data\": [\".h5ad\", \".png\", \".pdf\"]}",
              "plan_type": "ai"
            },
            {
              "title": "结果可视化",
              "tools": "monocle2",
              "step": 3,
              "previous_step": [
                "2"
              ],
              "name": "结果可视化",
              "oid": "monocle2_visualization",
              "description": "对拟时序分析的结果进行可视化，包括细胞在轨迹上的分布、拟时序值的分布以及分支点的可视化。该步骤将帮助理解细胞的发育或分化过程。",
              "input": "{\"trajectory_data\": [\".h5ad\"]}",
              "output": "{\"visualization\": [\".png\", \".pdf\"]}",
              "plan_type": "wdl"
            }
          ]
        }

plan_desc_step3_ai={
"title": "拟时序分析",
"tools": "monocle2",
"step": 2,
"previous_step": [
  "1"
],
"name": "拟时序分析",
"oid": "monocle2_pseudotime",
"description": "使用monocle2进行拟时序分析，推断细胞在发育或分化过程中的时间顺序。该步骤将构建细胞轨迹，计算每个细胞的拟时序值，并识别轨迹上的分支点。关键参数包括选择的高变基因数量和降维方法。",
"input": "{\"processed_data\": [\".h5ad\"]}",
"output": "{\"trajectory_data\": [\".h5ad\", \".png\", \".pdf\"]}",
"plan_type": "ai"
}

images_error_check={
  "error": {
    "code": "IMAGE_CREATION_FAILED",
    "message": "Failed to create the Docker image due to missing dependencies.",
    "details": {
      "missing_dependencies": [
        "python3",
        "curl"
      ],
      "suggestions": [
        "Ensure all dependencies are listed in the Dockerfile.",
        "Run `apt-get update` before installing packages."
      ]
    },
    "timestamp": "2025-07-21T14:38:00Z",
    "status": "failed"
  }
}

aa_input={'Stereo_Miner_Autoannotation_v1.SampleID': 'String', 'Stereo_Miner_Autoannotation_v1.h5ad': 'File', 'Stereo_Miner_Autoannotation_v1.reference': 'String', 'Stereo_Miner_Autoannotation_v1.UseGenes': 'String (default = "de")', 'Stereo_Miner_Autoannotation_v1.DeMethod': 'String (default = "classic")', 'Stereo_Miner_Autoannotation_v1.AutoTool': 'String (default = "SingleR")', 'Stereo_Miner_Autoannotation_v1.Source': 'String (default = "Default")', 'Stereo_Miner_Autoannotation_v1.annocluster': 'String (default = "seurat_clusters")'}
aa_output={'Stereo_Miner_Autoannotation_v1.outh5ad': 'File? (optional)', 'Stereo_Miner_Autoannotation_v1.csv': 'File? (optional)', 'Stereo_Miner_Autoannotation_v1.heatmap': 'File? (optional)', 'Stereo_Miner_Autoannotation_v1.heatmap_pdf': 'File? (optional)', 'Stereo_Miner_Autoannotation_v1.umap': 'File? (optional)', 'Stereo_Miner_Autoannotation_v1.umap_pdf': 'File? (optional)', 'Stereo_Miner_Autoannotation_v1.find_marker_genes': 'File? (optional)', 'Stereo_Miner_Autoannotation_v1.marker_gene_heatmap': 'File? (optional)', 'Stereo_Miner_Autoannotation_v1.marker_gene_heatmap_pdf': 'File? (optional)', 'Stereo_Miner_Autoannotation_v1.warning': 'File? (optional)'}
fj_input={'Stereo_Miner_Enrichment_v1.SampleID': 'String', 'Stereo_Miner_Enrichment_v1.Markercsv': 'File', 'Stereo_Miner_Enrichment_v1.p': 'Float (default = 0.05)', 'Stereo_Miner_Enrichment_v1.reference': 'String', 'Stereo_Miner_Enrichment_v1.pAdjustMethod': 'String (default = "BH")'}
fj_output={'Stereo_Miner_Enrichment_v1.enrichment_result': 'Array[File]'}

planning={
  "result": [
    {
      "title": "数据质控分析",
      "tools": "",
      "step": 1,
      "previous_step": [
        "SAW标准分析"
      ],
      "name": "Stereo_Miner_data_qc",
      "oid": "6840fa0845902327e1a41215",
      "description": "该WDL的核心功能是对单细胞转录组数据进行质量控制分析，包括统计每个细胞的总分子标识符(MID)计数、基因类型数量以及线粒体基因百分比，并生成可视化图表和质量控制信息文件。",
      "input": "{\"StereoMiner_dataQC_v0.Gef\": [\".gef\"]}",
      "output": "{\"output\": [\".json\", \".pdf\", \".png\", \".txt\"]}",
      "plan_type": "wdl"
    },
    {
      "title": "数据预处理",
      "tools": "",
      "step": 2,
      "previous_step": [
        "数据质控分析"
      ],
      "name": "Stereo_Miner_Preprocessing",
      "oid": "6840fa0745902327e1a41202",
      "description": "该WDL的核心功能是对空间转录组原始数据进行预处理，包括数据过滤、标准化和识别高变基因，以生成可靠的下游分析数据集。",
      "input": "{\"StereoMiner_Preprocessing_v0.Gef\": [\".gef\"]}",
      "output": "{\"output\": [\".h5ad\", \".json\", \".pdf\", \".png\", \".txt\"]}",
      "plan_type": "wdl"
    },
    {
      "title": "细胞聚类分析",
      "tools": "",
      "step": 3,
      "previous_step": [
        "数据预处理"
      ],
      "name": "Stereo_Miner_Clustering",
      "oid": "6840fa0845902327e1a4121c",
      "description": "该WDL的核心功能是通过UMAP降维和leiden/louvain聚类算法对标准化表达矩阵进行分析，识别细胞亚群并生成标记基因表。",
      "input": "{\"StereoMiner_Clustering_v1.h5File\": [\".h5ad\"]}",
      "output": "{\"output\": [\".csv\", \".h5ad\", \".json\", \".pdf\", \".png\"]}",
      "plan_type": "wdl"
    },
    {
      "title": "细胞注释",
      "tools": "",
      "step": 4,
      "previous_step": [
        "细胞聚类分析"
      ],
      "name": "Stereo_Miner_Autoannotation",
      "oid": "6840fa0845902327e1a41229",
      "description": "该WDL工作流的核心功能是使用SingleR工具基于参考数据集对单细胞进行自动细胞类型注释，包括内存估算、参考数据获取和细胞类型标注等步骤。",
      "input": "{\"Stereo_Miner_Autoannotation_v1.h5ad\": [\".h5ad\"], \"Stereo_Miner_Autoannotation_v1.reference\": [\".h5ad\"]}",
      "output": "{\"output\": [\".csv\", \".h5ad\", \".json\", \".pdf\", \".png\"]}",
      "plan_type": "wdl"
    },
    {
      "title": "富集分析",
      "tools": "",
      "step": 5,
      "previous_step": [
        "细胞聚类分析",
        "细胞注释"
      ],
      "name": "Stereo_Miner_Enrichment",
      "oid": "6840fa0745902327e1a4120f",
      "description": "该WDL的核心功能是：基于stereopy生成的marker_gene.csv表格，使用clusterProfiler对每个细胞类型的差异表达基因进行GO和KEGG功能富集分析，并生成可视化图表和结果列表。",
      "input": "{\"Stereo_Miner_Enrichment_v1.Markercsv\": [\".csv\"]}",
      "output": "{\"output\": [\".json\", \".pdf\", \".png\", \".xls\"]}",
      "plan_type": "wdl"
    },
    {
      "title": "细胞互作分析",
      "tools": "",
      "step": 6,
      "previous_step": [
        "细胞聚类分析",
        "细胞注释"
      ],
      "name": "Stereo_Miner_Interaction",
      "oid": "6840fa0745902327e1a41209",
      "description": "该WDL工作流的核心功能是使用CellChat和Cellphonedb两种工具分析单细胞空间转录组数据中不同细胞簇之间的相互作用关系，并生成可视化结果和统计表格。",
      "input": "{\"Stereo_Miner_Interaction_v0.h5ad\": [\".h5ad\"]}",
      "output": "{\"output\": [\".csv\", \".h5seurat\", \".json\", \".pdf\", \".png\", \".rds\"]}",
      "plan_type": "wdl"
    }
  ]
}

plan_steps_1={
      "planning_steps": [
        {
          "title": "细胞注释",
          "tools": "",
          "step": 1,
          "previous_step": [
            "细胞聚类分析"
          ],
          "name": "Stereo_Miner_Autoannotation",
          "oid": "6840fa0845902327e1a41229",
          "description": "该WDL工作流的核心功能是使用SingleR工具基于参考数据集对单细胞进行自动细胞类型注释，包括内存估算、参考数据获取和细胞类型标注等步骤。",
          "input": "{\"Stereo_Miner_Autoannotation_v1.h5ad\": [\".h5ad\"], \"Stereo_Miner_Autoannotation_v1.reference\": [\".h5ad\"]}",
          "output": "{\"output\": [\".csv\", \".h5ad\", \".json\", \".pdf\", \".png\"]}",
          "plan_type": "wdl"
        },
        {
          "title": "富集分析",
          "tools": "",
          "step": 2,
          "previous_step": [
            "细胞聚类分析",
            "细胞注释"
          ],
          "name": "Stereo_Miner_Enrichment",
          "oid": "6840fa0745902327e1a4120f",
          "description": "该WDL的核心功能是：基于stereopy生成的marker_gene.csv表格，使用clusterProfiler对每个细胞类型的差异表达基因进行GO和KEGG功能富集分析，并生成可视化图表和结果列表。",
          "input": "{\"Stereo_Miner_Enrichment_v1.Markercsv\": [\".csv\"]}",
          "output": "{\"output\": [\".json\", \".pdf\", \".png\", \".xls\"]}",
          "plan_type": "wdl"
        },
        {
          "title": "细胞互作分析",
          "tools": "",
          "step": 3,
          "previous_step": [
            "细胞聚类分析",
            "细胞注释"
          ],
          "name": "Stereo_Miner_Interaction",
          "oid": "6840fa0745902327e1a41209",
          "description": "该WDL工作流的核心功能是使用CellChat和Cellphonedb两种工具分析单细胞空间转录组数据中不同细胞簇之间的相互作用关系，并生成可视化结果和统计表格。",
          "input": "{\"Stereo_Miner_Interaction_v0.h5ad\": [\".h5ad\"]}",
          "output": "{\"output\": [\".csv\", \".h5seurat\", \".json\", \".pdf\", \".png\", \".rds\"]}",
          "plan_type": "wdl"
        }
      ]
    }

plan_steps_2={
  "arg1": [
    {
      "structured_output": {
        "target_analysis": "富集分析",
        "current_status": "数据已完成细胞聚类分析，当前为.h5ad格式，需要细胞注释步骤",
        "required_steps": [
          {
            "step_order": 1,
            "node_name": "细胞注释",
            "model_id": "6",
            "tools": "",
            "reason": "为细胞群体添加生物学注释，是富集分析的依赖条件"
          },
          {
            "step_order": 2,
            "node_name": "富集分析",
            "model_id": "9",
            "tools": "",
            "reason": "目标分析，研究细胞群体的功能富集情况"
          }
        ],
        "missing_dependencies": [
          "细胞注释"
        ],
        "feasibility": "可行，需要补充步骤",
        "recommendations": "建议先完成细胞注释步骤，确保细胞群体有正确的生物学注释后再进行富集分析"
      }
    }
  ]
}